(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[837],{20837:function(t,n,e){"use strict";e.r(n),e.d(n,{default:function(){return App}});var i=e(15861),r=e(86854),o=e(67294),a=e(63596),s=e(6424),c=e(1715),d=e(85893),useProvider=function(){var t=(0,o.useState)(),n=(0,r.Z)(t,2),e=n[0],i=n[1];return(0,o.useEffect)(function(){i(window.aptos||new a.Of({}))},[]),e};function App(){var t,n,e,a,u,l=useProvider(),h=(0,o.useState)(""),g=(0,r.Z)(h,2),p=g[0],v=g[1],_=(0,o.useState)(!1),f=(0,r.Z)(_,2),m=f[0],w=f[1],y=(0,o.useState)(null),A=(0,r.Z)(y,2),b=A[0],C=A[1];if((0,o.useEffect)(function(){if(l)return l.on("connect",function(t){w(!0),C(t),console.log("aptos.on [connect] ".concat(t))}),l.on("disconnect",function(){C(null),w(!1),console.log("aptos.on [disconnect] \uD83D\uDC4B")}),l.on("networkChange",function(t){v(t),console.log("aptos.on [networkChange] ".concat(t))}),l.on("accountChanged",function(t){C(t),w(!!t),console.log("aptos.on [accountChange] ".concat(t))}),l.onNetworkChange(function(t){v(t),console.log("aptos [onNetworkChange] ".concat(t))}),l.onAccountChange(function(t){C(t),t?(w(!0),console.log("aptos [onAccountChange] Switched account to ".concat(t))):(console.log("aptos [onAccountChange] Switched unknown account"),l.connect().then(function(){return console.log("[accountChanged] Reconnected successfully")}).catch(function(t){console.log("[accountChanged] Failed to re-connect: ".concat(t.message))}))}),function(){l.disconnect()}},[l]),!l)return(0,d.jsx)("h2",{children:"Could not find a provider"});var k=(t=(0,i.Z)(function*(){try{var t=yield l.connect(),n=yield l.network();C(t.address),v(n),w(!0),console.log("[connectWallet] account",t,n)}catch(t){console.warn(t),console.log("[error] connect: ".concat(JSON.stringify(t)))}}),function(){return t.apply(this,arguments)}),M=(n=(0,i.Z)(function*(){try{yield l.disconnect()}catch(t){console.warn(t),console.log("[error] disconnect: ".concat(JSON.stringify(t)))}}),function(){return n.apply(this,arguments)}),T=(e=(0,i.Z)(function*(){console.log("[signTransaction]",(yield l.signAndSubmitTransaction({arguments:[b,"100000"],function:"0x1::coin::transfer",type:"entry_function_payload",type_arguments:["0x1::aptos_coin::AptosCoin"]})))}),function(){return e.apply(this,arguments)}),x=(a=(0,i.Z)(function*(){console.log("[signTransaction]",(yield l.signTransaction({arguments:[b,"100000"],function:"0x1::coin::transfer",type:"entry_function_payload",type_arguments:["0x1::aptos_coin::AptosCoin"]})))}),function(){return a.apply(this,arguments)}),S=(u=(0,i.Z)(function*(){console.log("[signMessage]",(yield l.signMessage({address:!1,application:!0,chainId:!0,message:"This is a sample message",nonce:12345})))}),function(){return u.apply(this,arguments)});return(0,d.jsxs)("div",{children:[(0,d.jsx)(s.p,{dapps:c.F}),!l&&(0,d.jsx)("a",{target:"_blank",href:"https://www.onekey.so/download/",children:"Install OneKey Extension →"}),(0,d.jsx)("main",{children:l&&m?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{children:[(0,d.jsxs)("pre",{children:["Network: ",p]}),(0,d.jsxs)("pre",{children:["Connected as: ",b]})]}),(0,d.jsx)("button",{onClick:T,children:"Sign&Send Transaction"}),(0,d.jsx)("button",{onClick:x,children:"Sign Transaction "}),(0,d.jsx)("button",{onClick:S,children:"Sign Message"}),(0,d.jsx)("button",{onClick:function(){return M()},children:"Disconnect"})]}):(0,d.jsx)(d.Fragment,{children:(0,d.jsx)("button",{onClick:function(){return k()},children:"Connect Wallet"})})})]})}},1715:function(t,n,e){"use strict";e.d(n,{F:function(){return i}});var i=[{name:"SEAM",url:"https://app.seam.money/"},{name:"Aptos Names",url:"https://www.aptosnames.com/"},{name:"Liquid Swap",url:"https://liquidswap.com/#/"}]},6424:function(t,n,e){"use strict";e.d(n,{p:function(){return DAppList}}),e(67294);var i=e(36612),r=e.n(i),o=e(85893);function DAppList(t){var n=t.dapps;return(0,o.jsxs)("div",{className:r().container,children:[(0,o.jsx)("h3",{children:"Top DApps"}),(0,o.jsx)("ul",{children:n.map(function(t){return(0,o.jsx)("li",{children:(0,o.jsxs)("a",{href:t.url,target:"_blank",children:[t.name," ↗"]})},t.name)})})]})}},36612:function(t){t.exports={container:"Home_container__d256j",main:"Home_main__VkIEL",footer:"Home_footer__yFiaX",title:"Home_title__hYX6j",description:"Home_description__uXNdx",code:"Home_code__VVrIr",grid:"Home_grid__AVljO",card:"Home_card__E5spL",logo:"Home_logo__IOQAX"}},22519:function(t,n,e){"use strict";e.d(n,{R:function(){return getOrCreateExtInjectedJsBridge}});var i=e(57069);let{JS_BRIDGE_MESSAGE_DIRECTION:r,JS_BRIDGE_MESSAGE_EXT_CHANNEL:o}=i.consts;function getOrCreateExtInjectedJsBridge(t={}){let n=(0,i.Pk)(()=>new JsBridgeExtInjected(Object.assign(Object.assign({},t),{receiveHandler:i.gZ})));return n}let a=!1;let JsBridgeExtInjected=class JsBridgeExtInjected extends i.ZN{constructor(t){super(t),this.sendAsString=!1,this.isInjected=!0,function(t={}){let n=t.debugLogger||i.go;a||(a=!0,window.addEventListener("message",e=>{var i,a;if(e.source!==window)return;let s=e.data;if(s.channel===o&&s.direction===r.HOST_TO_INPAGE){n.extInjected("onWindowPostMessage",s);let e=s.payload,r=null!==(i=t.bridge)&&void 0!==i?i:null===(a=null==window?void 0:window.$onekey)||void 0===a?void 0:a.jsBridge;r&&r.receive(e)}},!1))}({debugLogger:this.debugLogger,bridge:this})}sendPayload(t){window.postMessage({channel:o,direction:r.INPAGE_TO_HOST,payload:t})}}},63596:function(t,n,e){"use strict";e.d(n,{Of:function(){return ProviderAptos},GR:function(){return ProviderAptosMartian}});var i=e(22519),r=e(10366),o=e(57069);let ProviderAptosBase=class ProviderAptosBase extends o.BX{constructor(t){super(t),this.providerName=r.U.aptos}request(t){return this.bridgeRequest(t)}};var a=e(14859),s=e(48764).Buffer,__awaiter=function(t,n,e,i){return new(e||(e=Promise))(function(r,o){function fulfilled(t){try{step(i.next(t))}catch(t){o(t)}}function rejected(t){try{step(i.throw(t))}catch(t){o(t)}}function step(t){var n;t.done?r(t.value):((n=t.value)instanceof e?n:new e(function(t){t(n)})).then(fulfilled,rejected)}step((i=i.apply(t,n||[])).next())})};let c={accountChanged:"accountChanged",networkChange:"networkChange",message_low_level:"message_low_level"};function isWalletEventMethodMatch({method:t,name:n}){return t===`wallet_events_${n}`}let ProviderAptos=class ProviderAptos extends ProviderAptosBase{constructor(t){super(Object.assign(Object.assign({},t),{bridge:t.bridge||(0,i.R)({timeout:t.timeout})})),this._account=null,this.aptosProviderType="petra",this._registerEvents()}get publicKey(){var t,n;return null!==(n=null===(t=this._account)||void 0===t?void 0:t.publicKey)&&void 0!==n?n:null}_registerEvents(){window.addEventListener("onekey_bridge_disconnect",()=>{this._handleDisconnected()}),this.on(c.message_low_level,t=>{if(!t)return;let{method:n,params:e}=t;isWalletEventMethodMatch({method:n,name:c.accountChanged})&&this._handleAccountChange(e),isWalletEventMethodMatch({method:n,name:c.networkChange})&&this._handleNetworkChange(e)})}_callBridge(t){return t.aptosProviderType=this.aptosProviderType,this.bridgeRequest(t)}_handleConnected(t,n={emit:!0}){var e;if(this._account=t,n.emit&&this.isConnectionStatusChanged("connected")){this.connectionStatus="connected";let n=null!==(e=null==t?void 0:t.address)&&void 0!==e?e:null;this.emit("connect",n),this.emit("accountChanged",n)}}_handleDisconnected(t={emit:!0}){this._account=null,t.emit&&this.isConnectionStatusChanged("disconnected")&&(this.connectionStatus="disconnected",this.emit("disconnect"),this.emit("accountChanged",null))}isAccountsChanged(t){var n;return(null==t?void 0:t.address)!==(null===(n=this._account)||void 0===n?void 0:n.address)}_handleAccountChange(t){if(this.isAccountsChanged(t)&&this.emit("accountChanged",(null==t?void 0:t.address)||null),!t){this._handleDisconnected();return}this._handleConnected(t,{emit:!1})}isNetworkChanged(t){return void 0===this._network||t!==this._network}_handleNetworkChange(t){this.isNetworkChanged(t)&&this.emit("networkChange",t||null),this._network=t}connect(){return __awaiter(this,void 0,void 0,function*(){if(this._account)return Promise.resolve(this._account);let t=yield this._callBridge({method:"connect",params:void 0});if(!t)throw a.b$.provider.unauthorized();return this._handleConnected(t,{emit:!0}),t})}isConnected(){return null!==this._account}account(){return __awaiter(this,void 0,void 0,function*(){let t=yield this._callBridge({method:"account",params:void 0});if(!t)throw a.b$.provider.unauthorized();return Promise.resolve(t)})}signAndSubmitTransaction(t){return __awaiter(this,void 0,void 0,function*(){let n=yield this._callBridge({method:"signAndSubmitTransaction",params:t});if(!n)throw a.b$.provider.unauthorized();return JSON.parse(n)})}signTransaction(t){return __awaiter(this,void 0,void 0,function*(){let n=yield this._callBridge({method:"signTransaction",params:t});if(!n)throw a.b$.provider.unauthorized();return new Uint8Array(s.from(n,"hex"))})}signMessage(t){return this._callBridge({method:"signMessage",params:t})}network(){return this._callBridge({method:"network",params:void 0})}getNetworkURL(){return this._callBridge({method:"getNetworkURL",params:void 0})}disconnect(){return __awaiter(this,void 0,void 0,function*(){yield this._callBridge({method:"disconnect",params:void 0}),this._handleDisconnected()})}onNetworkChange(t){return super.on(c.networkChange,t)}onAccountChange(t){return super.on(c.accountChanged,t)}on(t,n){return super.on(t,n)}emit(t,...n){return super.emit(t,...n)}};var d=e(48764).Buffer,OnekeyMartianAptosProvider_awaiter=function(t,n,e,i){return new(e||(e=Promise))(function(r,o){function fulfilled(t){try{step(i.next(t))}catch(t){o(t)}}function rejected(t){try{step(i.throw(t))}catch(t){o(t)}}function step(t){var n;t.done?r(t.value):((n=t.value)instanceof e?n:new e(function(t){t(n)})).then(fulfilled,rejected)}step((i=i.apply(t,n||[])).next())})};let ProviderAptosMartian=class ProviderAptosMartian extends ProviderAptos{constructor(t){super(Object.assign(Object.assign({},t),{bridge:t.bridge||(0,i.R)({timeout:t.timeout})})),this.isMartian=!0,window.dispatchEvent(new Event("martian#initialized"))}get publicKey(){var t,n;return null!==(n=null===(t=this._account)||void 0===t?void 0:t.publicKey)&&void 0!==n?n:null}_callMartianBridge(t){return t.aptosProviderType=this.aptosProviderType,this.bridgeRequest(t)}signAndSubmitTransaction(t){return OnekeyMartianAptosProvider_awaiter(this,void 0,void 0,function*(){if("string"==typeof t)return yield this._callMartianBridge({method:"martianSignAndSubmitTransaction",params:t});{let n=yield this._callMartianBridge({method:"signAndSubmitTransaction",params:t});if(!n)throw a.b$.provider.unauthorized();return JSON.parse(n)}})}signTransaction(t){return OnekeyMartianAptosProvider_awaiter(this,void 0,void 0,function*(){if("string"==typeof t)return this._callMartianBridge({method:"martianSignTransaction",params:t});{let n=yield this._callMartianBridge({method:"signTransaction",params:t});if(!n)throw a.b$.provider.unauthorized();return new Uint8Array(d.from(n,"hex"))}})}signGenericTransaction(t){return OnekeyMartianAptosProvider_awaiter(this,void 0,void 0,function*(){return this._callMartianBridge({method:"signGenericTransaction",params:{func:t.func,args:t.args,type_args:t.type_args}})})}generateSignAndSubmitTransaction(t,n,e){return OnekeyMartianAptosProvider_awaiter(this,void 0,void 0,function*(){let i=yield this.generateTransaction(t,n,e),r=yield this.signAndSubmitTransaction(i);return r})}createCollection(t,n,e){return OnekeyMartianAptosProvider_awaiter(this,void 0,void 0,function*(){return this._callMartianBridge({method:"createCollection",params:{name:t,description:n,uri:e}})})}createToken(t,n,e,i,r,o,a,s,c,d,u,l){return OnekeyMartianAptosProvider_awaiter(this,void 0,void 0,function*(){return this._callMartianBridge({method:"createToken",params:{collectionName:t,name:n,description:e,supply:i,uri:r,max:o,royalty_payee_address:a,royalty_points_denominator:s,royalty_points_numerator:c,property_keys:d,property_values:u,property_types:l}})})}generateTransaction(t,n,e){return OnekeyMartianAptosProvider_awaiter(this,void 0,void 0,function*(){return this._callMartianBridge({method:"generateTransaction",params:{sender:t,payload:n,options:e}})})}_convertStringToUint8Array(t){return new Uint8Array(t.split(",").map(t=>parseInt(t,10)))}_convertMaybeHexStringTostring(t){return"string"==typeof t?t:t.toString()}_convertAnyNumberToString(t){return"string"==typeof t?t:t.toString()}submitTransaction(t){return OnekeyMartianAptosProvider_awaiter(this,void 0,void 0,function*(){let n="string"==typeof t?this._convertStringToUint8Array(t):t;return this._callMartianBridge({method:"submitTransaction",params:d.from(n).toString("hex")})})}getTransactions(t){return OnekeyMartianAptosProvider_awaiter(this,void 0,void 0,function*(){return this._callMartianBridge({method:"getTransactions",params:Object.assign(Object.assign({},t),{start:(null==t?void 0:t.start)?this._convertAnyNumberToString(t.start):void 0})})})}getTransaction(t){return OnekeyMartianAptosProvider_awaiter(this,void 0,void 0,function*(){return this._callMartianBridge({method:"getTransaction",params:t})})}getAccountTransactions(t,n){return OnekeyMartianAptosProvider_awaiter(this,void 0,void 0,function*(){return this._callMartianBridge({method:"getAccountTransactions",params:{accountAddress:this._convertMaybeHexStringTostring(t),query:Object.assign(Object.assign({},n),{start:(null==n?void 0:n.start)?this._convertAnyNumberToString(n.start):void 0})}})})}getAccountResources(t,n){return OnekeyMartianAptosProvider_awaiter(this,void 0,void 0,function*(){return this._callMartianBridge({method:"getAccountResources",params:{accountAddress:this._convertMaybeHexStringTostring(t),query:Object.assign(Object.assign({},n),{ledgerVersion:(null==n?void 0:n.ledgerVersion)?this._convertAnyNumberToString(n.ledgerVersion):void 0})}})})}getAccount(t){return OnekeyMartianAptosProvider_awaiter(this,void 0,void 0,function*(){return this._callMartianBridge({method:"getAccount",params:this._convertMaybeHexStringTostring(t)})})}getChainId(){return OnekeyMartianAptosProvider_awaiter(this,void 0,void 0,function*(){return this._callMartianBridge({method:"getChainId",params:void 0})})}getLedgerInfo(){return OnekeyMartianAptosProvider_awaiter(this,void 0,void 0,function*(){return this._callMartianBridge({method:"getLedgerInfo",params:void 0})})}}}}]);
//# sourceMappingURL=837.6157852abad7cbcf.js.map